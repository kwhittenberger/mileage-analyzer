================================================================================
BUSINESS LOOKUP SYSTEM - How It Works
D'Ewart Representatives, L.L.C.
================================================================================

OVERVIEW
--------
The mileage tool uses a smart 3-layer system to identify businesses:

  Layer 1: Manual Mapping (YOU control)
     └─> Layer 2: Cached Lookups (automatic, saved)
           └─> Layer 3: Online Lookup (automatic, for new addresses)

This gives you the best of both worlds: automatic lookup for common businesses,
with the ability to add specific customer names.


WHAT GETS FOUND AUTOMATICALLY
------------------------------
When you enable lookup (choose Y), the tool will automatically find:

✓ Gas stations (Shell, Chevron, 76, BP, etc.)
✓ Restaurants and cafes
✓ Grocery stores and shops
✓ Banks and post offices
✓ Named buildings and landmarks

Example: "Shell Gas Station" instead of just "123 Main St"


WHAT NEEDS MANUAL MAPPING
--------------------------
The following won't be found automatically and need manual entries:

✗ Customer business locations (not public POIs)
✗ Office buildings without public names
✗ Residential addresses
✗ Unnamed business parks

Example: You visit "9206 NE 180th St, Bothell" - only you know this is
"Customer ABC Headquarters"


HOW TO USE MANUAL MAPPING
--------------------------

STEP 1: Run analysis with lookup enabled
   python analyze_mileage.py volvo-trips-log.csv --lookup

STEP 2: Open detailed_trips.csv in Excel

STEP 3: Look at the "Business Name" column
   - Entries like "Shell Gas Station" = Good! (auto-found)
   - Entries like "9206 NE 180th St" = Needs mapping (just street address)

STEP 4: Copy the full address from the "End Address" column

STEP 5: Open business_mapping.json in Notepad

STEP 6: Add an entry (following the format):
   {
     "9206 NE 180th St, Bothell": "Customer ABC Main Office",
     "18524 NE 191st St, Woodinville": "Client XYZ Distribution Center"
   }

STEP 7: Save and re-run the analysis
   - No need for --lookup flag anymore
   - Manual mappings are instant (no internet needed)
   - Your custom names will now appear in all reports


REAL EXAMPLE
------------

WITHOUT MANUAL MAPPING:
  Date        Category   Distance   End Address                Business Name
  ----------  ---------  ---------  -------------------------  ----------------
  2025-01-15  Business   12.3 mi    9206 NE 180th St, Bothell  9206 NE 180th St
  2025-01-15  Business   0.5 mi     76 Gas Station, Bothell    Gas Station / Fuel

WITH MANUAL MAPPING:
  Date        Category   Distance   End Address                Business Name
  ----------  ---------  ---------  -------------------------  ----------------------
  2025-01-15  Business   12.3 mi    9206 NE 180th St, Bothell  TechCorp Customer Site
  2025-01-15  Business   0.5 mi     76 Gas Station, Bothell    Gas Station / Fuel


FILE EXPLANATIONS
-----------------

business_mapping.json
  - YOU edit this file
  - Add addresses and business names
  - Checked FIRST (highest priority)
  - Works even without --lookup flag

address_cache.json
  - AUTO-GENERATED by the tool
  - Don't edit manually
  - Stores results from online lookups
  - Speeds up subsequent runs

detailed_trips.csv
  - OUTPUT file
  - Contains the "Business Name" column
  - This is what appears on your tax reports


TIPS & BEST PRACTICES
----------------------

1. FIRST TIME SETUP:
   - Run with --lookup to auto-find gas stations/stores
   - Review the output CSV
   - Add manual mappings for frequent customer sites
   - Future runs are instant with cached results

2. ADDING NEW ADDRESSES:
   - Copy exact address from CSV (including city)
   - Use meaningful business names for tax purposes
   - Add commas between entries in JSON file

3. FOR TAX REPORTING:
   - Generic names like "Customer Site" are fine
   - Or use specific names like "ABC Corp - Warehouse"
   - The address is always preserved in the CSV

4. TROUBLESHOOTING:
   - If manual mapping doesn't work, check for typos
   - Address must match EXACTLY (including capitalization)
   - Make sure JSON syntax is correct (commas, quotes)
   - Test with a small entry first


WORKFLOW RECOMMENDATION
-----------------------

INITIAL SETUP (once):
  1. Run: python analyze_mileage.py volvo-trips-log.csv --lookup
  2. Wait for it to complete (~1 second per unique business address)
  3. Open detailed_trips.csv
  4. Find trips with just street addresses in Business Name column
  5. Add those to business_mapping.json
  6. Save the mapping file

MONTHLY ROUTINE (fast):
  1. Export new trips from your vehicle tracker
  2. Replace volvo-trips-log.csv
  3. Double-click run_mileage_analysis.bat
  4. Choose N (no lookup needed - uses cache and mappings)
  5. Review the generated CSVs
  6. Add any new customer addresses to mapping file if needed


QUESTIONS?
----------
The lookup system is designed to save you time while giving you control.

- Common businesses (gas, food, stores): Auto-detected
- Your specific customers: You name them once, used forever
- All results cached for speed

Contact: doug@dewart.com


================================================================================
